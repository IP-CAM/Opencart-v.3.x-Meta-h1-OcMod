<?xml version="1.0" encoding="utf-8"?>
<modification>
    <name>Meta h1 oc3</name>
    <code>meta_h1_oc3</code>
    <version>1.0</version>
    <author>eapdob</author>
    <link>eapdob@gmail.com</link>
    <!-- category -->
    <file path="admin/controller/catalog/category.php">
        <operation>
            <search><![CDATA[if (isset($this->error['meta_title'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($this->error['meta_h1'])) {
                    $data['error_meta_h1'] = $this->error['meta_h1'];
                } else {
                    $data['error_meta_h1'] = array();
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[if ((utf8_strlen($value['meta_title']) < 1) || (utf8_strlen($value['meta_title']) > 255)) {]]></search>
            <add offset="2" position="replace"><![CDATA[
                if ((utf8_strlen($value['meta_title']) < 0) || (utf8_strlen($value['meta_title']) > 255)) {
                    $this->error['meta_title'][$language_id] = $this->language->get('error_meta_title');
                }

                if ((utf8_strlen($value['meta_h1']) < 0) || (utf8_strlen($value['meta_h1']) > 255)) {
                    $this->error['meta_h1'][$language_id] = $this->language->get('error_meta_h1');
                }
		    ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/category.php">
        <operation>
            <search><![CDATA["', meta_description = '"]]></search>
            <add position="replace"><![CDATA["', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '"]]></add>
        </operation>
        <operation>
            <search><![CDATA['meta_title'       => $result['meta_title'],]]></search>
            <add position="after"><![CDATA['meta_h1'       => $result['meta_h1'],]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/category.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML H1 tag';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML H1 tag must contain between 0 and 255 characters!';]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/catalog/category.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 должен содержать от 0 до 255 символов!';]]></add>
        </operation>
    </file>
    <file path="admin/language/uk-ua/catalog/category.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 повинен містити від 0 до 255 символів!';]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/category_form.twig">
        <operation>
            <search index="0"><![CDATA[<div class="form-group">]]></search>
            <add offset="5" position="replace"><![CDATA[]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[<div class="form-group required">]]></search>
            <add offset="8" position="replace"><![CDATA[
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="category_description[{{ language.language_id }}][meta_title]" value="{{ category_description[language.language_id] ? category_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control" />
                        {% if error_meta_title[language.language_id] %}
                            <div class="text-danger">{{ error_meta_title[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-h1{{ language.language_id }}">{{ entry_meta_h1 }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="category_description[{{ language.language_id }}][meta_h1]" value="{{ category_description[language.language_id] ? category_description[language.language_id].meta_h1 }}" placeholder="{{ entry_meta_h1 }}" id="input-meta-h1{{ language.language_id }}" class="form-control"/>
                        {% if error_meta_h1[language.language_id] %}
                            <div class="text-danger">{{ error_meta_h1[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
		    ]]></add>
        </operation>
        <operation>
            <search index="3"><![CDATA[<div class="form-group">]]></search>
            <add offset="5" position="after"><![CDATA[
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                    <div class="col-sm-10">
                        <textarea name="category_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="summernote" data-lang="{{ summernote }}" class="form-control">{{ category_description[language.language_id] ? category_description[language.language_id].description }}</textarea>
                    </div>
                </div>
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/category.php">
        <operation>
            <search><![CDATA[$this->document->setTitle($category_info['meta_title']);]]></search>
            <add position="replace"><![CDATA[
                if ($category_info['meta_title']) {
                    $this->document->setTitle($category_info['meta_title']);
                } else {
                    $this->document->setTitle($category_info['name']);
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['heading_title'] = $category_info['name'];]]></search>
            <add position="replace"><![CDATA[
                if ($category_info['meta_h1']) {
                    $data['heading_title'] = $category_info['meta_h1'];
                } else {
                    $data['heading_title'] = $category_info['name'];
                }
		    ]]></add>
        </operation>
    </file>
    <!-- product -->
    <file path="admin/controller/catalog/product.php">
        <operation>
            <search><![CDATA[if (isset($this->error['meta_title'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($this->error['meta_h1'])) {
                    $data['error_meta_h1'] = $this->error['meta_h1'];
                } else {
                    $data['error_meta_h1'] = array();
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[if ((utf8_strlen($value['meta_title']) < 1) || (utf8_strlen($value['meta_title']) > 255)) {]]></search>
            <add offset="2" position="replace"><![CDATA[
                if ((utf8_strlen($value['meta_title']) < 0) || (utf8_strlen($value['meta_title']) > 255)) {
                    $this->error['meta_title'][$language_id] = $this->language->get('error_meta_title');
                }

                if ((utf8_strlen($value['meta_h1']) < 0) || (utf8_strlen($value['meta_h1']) > 255)) {
                    $this->error['meta_h1'][$language_id] = $this->language->get('error_meta_h1');
                }
		    ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/product.php">
        <operation>
            <search><![CDATA["', meta_description = '"]]></search>
            <add position="replace"><![CDATA["', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '"]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/product.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML H1 tag';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML H1 tag must contain between 0 and 255 characters!';]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/catalog/product.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 должен содержать от 0 до 255 символов!';]]></add>
        </operation>
    </file>
    <file path="admin/language/uk-ua/catalog/product.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 повинен містити від 0 до 255 символів!';]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/product_form.twig">
        <operation>
            <search index="0"><![CDATA[<div class="form-group">]]></search>
            <add offset="5" position="replace"><![CDATA[]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[<div class="form-group required">]]></search>
            <add offset="7" position="replace"><![CDATA[
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="product_description[{{ language.language_id }}][meta_title]" value="{{ product_description[language.language_id] ? product_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control"/>
                        {% if error_meta_title[language.language_id] %}
                            <div class="text-danger">{{ error_meta_title[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-h1{{ language.language_id }}">{{ entry_meta_h1 }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="product_description[{{ language.language_id }}][meta_h1]" value="{{ product_description[language.language_id] ? product_description[language.language_id].meta_h1 }}" placeholder="{{ entry_meta_h1 }}" id="input-meta-h1{{ language.language_id }}" class="form-control"/>
                        {% if error_meta_h1[language.language_id] %}
                            <div class="text-danger">{{ error_meta_h1[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
		    ]]></add>
        </operation>
        <operation>
            <search index="4"><![CDATA[<div class="form-group">]]></search>
            <add position="before"><![CDATA[
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                    <div class="col-sm-10">
                        <textarea name="product_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="summernote" data-lang="{{ summernote }}" class="form-control">{{ product_description[language.language_id] ? product_description[language.language_id].description }}</textarea>
                    </div>
                </div>
            ]]></add>
        </operation>
    </file>
    <file path="catalog/model/catalog/product.php">
        <operation>
            <search><![CDATA['meta_title'       => $query->row['meta_title'],]]></search>
            <add position="after"><![CDATA[
                'meta_h1'       => $query->row['meta_h1'],
		    ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/product.php">
        <operation>
            <search><![CDATA[$this->document->setTitle($product_info['meta_title']);]]></search>
            <add position="replace"><![CDATA[
                if ($product_info['meta_title']) {
                    $this->document->setTitle($product_info['meta_title']);
                } else {
                    $this->document->setTitle($product_info['name']);
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['heading_title'] = $product_info['name'];]]></search>
            <add position="replace"><![CDATA[
                if ($product_info['meta_h1']) {
                    $data['heading_title'] = $product_info['meta_h1'];
                } else {
                    $data['heading_title'] = $product_info['name'];
                }
		    ]]></add>
        </operation>
    </file>
    <!-- information -->
    <file path="admin/controller/catalog/information.php">
        <operation>
            <search><![CDATA[if (isset($this->error['meta_title'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($this->error['description'])) {
                    $data['error_description'] = $this->error['description'];
                } else {
                    $data['error_description'] = array();
                }

                if (isset($this->error['meta_h1'])) {
                    $data['error_meta_h1'] = $this->error['meta_h1'];
                } else {
                    $data['error_meta_h1'] = array();
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[if ((utf8_strlen($value['meta_title']) < 1) || (utf8_strlen($value['meta_title']) > 255)) {]]></search>
            <add offset="2" position="replace"><![CDATA[
                if ((utf8_strlen($value['meta_title']) < 0) || (utf8_strlen($value['meta_title']) > 255)) {
                    $this->error['meta_title'][$language_id] = $this->language->get('error_meta_title');
                }

                if ((utf8_strlen($value['meta_h1']) < 0) || (utf8_strlen($value['meta_h1']) > 255)) {
                    $this->error['meta_h1'][$language_id] = $this->language->get('error_meta_h1');
                }
		    ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/information.php">
        <operation>
            <search><![CDATA["', meta_description = '"]]></search>
            <add position="replace"><![CDATA["', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '"]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/information.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML H1 tag';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML H1 tag must contain between 0 and 255 characters!';]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/catalog/information.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="after"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 должен содержать от 0 до 255 символов!';]]></add>
        </operation>
    </file>
    <file path="admin/language/uk-ua/catalog/information.php">
        <operation>
            <search><![CDATA[$_['entry_meta_title']]]></search>
            <add position="after"><![CDATA[$_['entry_meta_h1']          = 'HTML-тег H1';]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_meta_title']]]></search>
            <add position="replace"><![CDATA[$_['error_meta_h1']          = 'HTML-тег H1 повинен містити від 0 до 255 символів!';]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/information_form.twig">
        <operation>
            <search index="1"><![CDATA[<div class="form-group required">]]></search>
            <add offset="7" position="replace"><![CDATA[]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[<div class="form-group required">]]></search>
            <add offset="7" position="replace"><![CDATA[
                <div class="form-group required">
                    <label class="col-sm-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="information_description[{{ language.language_id }}][meta_title]" value="{{ information_description[language.language_id] ? information_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control" />
                        {% if error_meta_title[language.language_id] %}
                            <div class="text-danger">{{ error_meta_title[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-2 control-label" for="input-meta-h1{{ language.language_id }}">{{ entry_meta_h1 }}</label>
                    <div class="col-sm-10">
                        <input type="text" name="information_description[{{ language.language_id }}][meta_h1]" value="{{ information_description[language.language_id] ? information_description[language.language_id].meta_h1 }}" placeholder="{{ entry_meta_h1 }}" id="input-meta-h1{{ language.language_id }}" class="form-control" />
                        {% if error_meta_h1[language.language_id] %}
                            <div class="text-danger">{{ error_meta_h1[language.language_id] }}</div>
                        {% endif %}
                    </div>
                </div>
		    ]]></add>
        </operation>
        <operation>
            <search index="2"><![CDATA[<div class="form-group">]]></search>
            <add offset="5" position="after"><![CDATA[
                <div class="form-group required">
                    <label class="col-sm-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                    <div class="col-sm-10">
                        <textarea name="information_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="summernote" data-lang="{{ summernote }}" class="form-control">{{ information_description[language.language_id] ? information_description[language.language_id].description }}</textarea>
                        {% if error_description[language.language_id] %}
                            <div class="text-danger">{{ error_description[language.language_id] }}</div>
                        {% endif %} </div>
                </div>
            ]]></add>
        </operation>
    </file>
    <file path="catalog/controller/information/information.php">
        <operation>
            <search><![CDATA[$this->document->setTitle($information_info['meta_title']);]]></search>
            <add position="replace"><![CDATA[
                if ($information_info['meta_title']) {
                    $this->document->setTitle($information_info['meta_title']);
                } else {
                    $this->document->setTitle($information_info['name']);
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['heading_title'] = $information_info['title'];]]></search>
            <add position="replace"><![CDATA[
                if ($information_info['meta_h1']) {
                    $data['heading_title'] = $information_info['meta_h1'];
                } else {
                    $data['heading_title'] = $information_info['title'];
                }
		    ]]></add>
        </operation>
    </file>
    <!-- manufacturer -->
    <file path="admin/controller/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[if (isset($this->error['name'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($this->error['meta_h1'])) {
                    $data['error_meta_h1'] = $this->error['meta_h1'];
                } else {
                    $data['error_meta_h1'] = array();
                }

                if (isset($this->error['meta_title'])) {
                    $data['error_meta_title'] = $this->error['meta_title'];
                } else {
                    $data['error_meta_title'] = array();
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[if (isset($this->request->post['name'])) {]]></search>
            <add position="before"><![CDATA[
                $this->load->model('localisation/language');
                $data['languages'] = $this->model_localisation_language->getLanguages();
                if (isset($this->request->post['manufacturer_description'])) {
                    $data['manufacturer_description'] = $this->request->post['manufacturer_description'];
                } elseif (isset($this->request->get['manufacturer_id'])) {
                    $data['manufacturer_description'] = $this->model_catalog_manufacturer->getManufacturerDescriptions($this->request->get['manufacturer_id']);
                } else {
                    $data['manufacturer_description'] = array();
                }

                if (!empty($manufacturer_info)) {
                    $data['heading_title'] = $data['name'] = $manufacturer_info['name'];
                } else {
                    $data['heading_title'] = $this->language->get('heading_title');
                }

                if (isset($this->request->post['manufacturer_layout'])) {
                    $data['manufacturer_layout'] = $this->request->post['manufacturer_layout'];
                } elseif (isset($this->request->get['manufacturer_id'])) {
                    $data['manufacturer_layout'] = $this->model_catalog_manufacturer->getManufacturerLayouts($this->request->get['manufacturer_id']);
                } else {
                    $data['manufacturer_layout'] = array();
                }
                $this->load->model('design/layout');

                $data['layouts'] = $this->model_design_layout->getLayouts();
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[if ((utf8_strlen($this->request->post['name']) < 1) || (utf8_strlen($this->request->post['name']) > 64)) {]]></search>
            <add offset="2" position="after"><![CDATA[
                foreach ($this->request->post['manufacturer_description'] as $language_id => $value) {
                    if ((utf8_strlen($value['meta_title']) < 0) || (utf8_strlen($value['meta_title']) > 255)) {
                        $this->error['meta_title'][$language_id] = $this->language->get('error_meta_title');
                    }

                    if ((utf8_strlen($value['meta_h1']) < 0) || (utf8_strlen($value['meta_h1']) > 255)) {
                        $this->error['meta_h1'][$language_id] = $this->language->get('error_meta_h1');
                    }
                }
            ]]></add>
        </operation>
    </file>
    <file path="admin/model/catalog/manufacturer.php">
        <operation>
            <search index="0"><![CDATA[if (isset($data['image'])) {]]></search>
            <add position="before"><![CDATA[
                if (isset($data['manufacturer_layout'])) {
                    foreach ($data['manufacturer_layout'] as $store_id => $layout_id) {
                        $this->db->query("INSERT INTO " . DB_PREFIX . "manufacturer_to_layout SET manufacturer_id = '" . (int)$manufacturer_id . "', store_id = '" . (int)$store_id . "', layout_id = '" . (int)$layout_id . "'");
                    }
                }
		    ]]></add>
        </operation>
        <operation>
            <search index="0"><![CDATA[if (isset($data['manufacturer_store'])) {]]></search>
            <add position="before"><![CDATA[
                foreach ($data['manufacturer_description'] as $language_id => $value) {
                    $this->db->query("INSERT INTO " . DB_PREFIX . "manufacturer_description SET manufacturer_id = '" . (int)$manufacturer_id . "', language_id = '" . (int)$language_id . "', description = '" . $this->db->escape($value['description']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[public function editManufacturer($manufacturer_id, $data) {]]></search>
            <add position="after"><![CDATA[
                $this->db->query("DELETE FROM " . DB_PREFIX . "manufacturer_to_layout WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");

                if (isset($data['manufacturer_layout'])) {
                    foreach ($data['manufacturer_layout'] as $store_id => $layout_id) {
                        $this->db->query("INSERT INTO " . DB_PREFIX . "manufacturer_to_layout SET manufacturer_id = '" . (int)$manufacturer_id . "', store_id = '" . (int)$store_id . "', layout_id = '" . (int)$layout_id . "'");
                    }
                }
		    ]]></add>
        </operation>
        <operation>
            <search index="1"><![CDATA[if (isset($data['image'])) {]]></search>
            <add offset="2" position="after"><![CDATA[
                $this->db->query("DELETE FROM " . DB_PREFIX . "manufacturer_description WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");

                foreach ($data['manufacturer_description'] as $language_id => $value) {
                    $this->db->query("INSERT INTO " . DB_PREFIX . "manufacturer_description SET manufacturer_id = '" . (int)$manufacturer_id . "', language_id = '" . (int)$language_id . "', description = '" . $this->db->escape($value['description']) . "', meta_title = '" . $this->db->escape($value['meta_title']) . "', meta_h1 = '" . $this->db->escape($value['meta_h1']) . "', meta_description = '" . $this->db->escape($value['meta_description']) . "', meta_keyword = '" . $this->db->escape($value['meta_keyword']) . "'");
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$this->db->query("DELETE FROM `" . DB_PREFIX . "manufacturer` WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");]]></search>
            <add position="after"><![CDATA[
                $this->db->query("DELETE FROM `" . DB_PREFIX . "manufacturer_to_layout` WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
		        $this->db->query("DELETE FROM `" . DB_PREFIX . "manufacturer_description` WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[public function getTotalManufacturers() {]]></search>
            <add position="before"><![CDATA[
                public function getManufacturerLayouts($manufacturer_id) {
                    $manufacturer_layout_data = array();
                    $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "manufacturer_to_layout WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
                    foreach ($query->rows as $result) {
                        $manufacturer_layout_data[$result['store_id']] = $result['layout_id'];
                    }
                    return $manufacturer_layout_data;
                }

                public function getTotalManufacturerByLayoutId($layout_id) {
                    $query = $this->db->query("SELECT COUNT(*) AS total FROM " . DB_PREFIX . "manufacturer_to_layout WHERE layout_id = '" . (int)$layout_id . "'");
                    return $query->row['total'];
                }

                public function getManufacturerDescriptions($manufacturer_id) {
                    $manufacturer_description_data = array();
                    $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "manufacturer_description WHERE manufacturer_id = '" . (int)$manufacturer_id . "'");
                    foreach ($query->rows as $result) {
                        $manufacturer_description_data[$result['language_id']] = array(
                            'meta_title'       => $result['meta_title'],
                            'meta_h1'      	   => $result['meta_h1'],
                            'meta_description' => $result['meta_description'],
                            'meta_keyword'     => $result['meta_keyword'],
                            'description'      => $result['description']
                        );
                    }
                    return $manufacturer_description_data;
                }
		    ]]></add>
        </operation>
    </file>
    <file path="admin/language/en-gb/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[$_['entry_name']]]></search>
            <add position="after"><![CDATA[
                $_['entry_description']      = 'Description';
                $_['entry_meta_h1']          = 'HTML H1 tag';
                $_['entry_meta_title']       = 'HTML Meta Title tag';
                $_['entry_meta_description'] = 'HTML Meta Description tag';
                $_['entry_meta_keyword']     = 'HTML Meta Keyword tag';
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_name']]]></search>
            <add position="after"><![CDATA[
                $_['error_meta_h1']          = 'HTML H1 tag must contain between 0 and 255 characters!';
                $_['error_meta_title']       = 'HTML Meta Title tag must contain between 0 and 255 characters!';
                $_['error_meta_description'] = 'HTML Meta Description tag must contain between 0 and 255 characters!';
                $_['error_meta_keyword']     = 'HTML Meta Keyword tag must contain between 0 and 255 characters!';
		    ]]></add>
        </operation>
    </file>
    <file path="admin/language/ru-ru/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[$_['entry_name']]]></search>
            <add position="after"><![CDATA[
                $_['entry_description']      = 'Описание:';
                $_['entry_meta_h1']          = 'HTML-тег H1';
                $_['entry_meta_title']       = 'Мета-тег Title';
                $_['entry_meta_description'] = 'Мета-тег Description';
                $_['entry_meta_keyword']     = 'Мета-тег Keywords';
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_name']]]></search>
            <add position="after"><![CDATA[
                $_['error_meta_h1']          = 'HTML-тег H1 должен содержать от 0 до 255 символов!';
                $_['error_meta_title']       = 'Мета-тег Title должен содержать от 0 до 255 символов!';
                $_['error_meta_description'] = 'Мета-тег Description должен содержать от 0 до 255 символов!';
                $_['error_meta_keyword']     = 'Мета-тег Keyword должен содержать от 0 до 255 символов!';
		    ]]></add>
        </operation>
    </file>
    <file path="admin/language/uk-ua/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[$_['entry_name']]]></search>
            <add position="after"><![CDATA[
                $_['entry_description']      = 'Опис:';
                $_['entry_meta_h1']          = 'HTML-тег H1';
                $_['entry_meta_title']       = 'Мета-тег Title';
                $_['entry_meta_description'] = 'Мета-тег Description';
                $_['entry_meta_keyword']     = 'Мета-тег Keywords';
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$_['error_name']]]></search>
            <add position="after"><![CDATA[
                $_['error_meta_h1']          = 'HTML-тег H1 повинен містити від 0 до 255 символів!';
                $_['error_meta_title']       = 'Мета-тег Title повинен містити від 0 до 255 символів!';
                $_['error_meta_description'] = 'Мета-тег Description повинен містити від 0 до 255 символів!';
                $_['error_meta_keyword']     = 'Мета-тег Keyword повинен містити від 0 до 255 символів!';
		    ]]></add>
        </operation>
    </file>
    <file path="admin/view/template/catalog/manufacturer_form.twig">
        <operation>
            <search><![CDATA[<li><a href="#tab-seo" data-toggle="tab">{{ tab_seo }}</a></li>]]></search>
            <add position="replace"><![CDATA[<li><a href="#tab-data" data-toggle="tab">{{ tab_data }}</a></li><li><a href="#tab-seo" data-toggle="tab">{{ tab_seo }}</a></li><li><a href="#tab-design" data-toggle="tab">{{ tab_design }}</a></li>]]></add>
        </operation>
        <operation>
            <search index="0"><![CDATA[<div class="form-group">]]></search>
            <add position="before"><![CDATA[
                <ul class="nav nav-tabs" id="language">
                    {% for language in languages %}
                        <li{% if loop.index == 1 %} class="active"{% endif %}><a href="#language{{ language.language_id }}" data-toggle="tab"><img src="language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /> {{ language.name }}</a></li>
                    {% endfor %}
                </ul>
                <div class="tab-content">
                    {% for language in languages %}
                        <div class="tab-pane{% if loop.index == 1 %} active{% endif %}" id="language{{ language.language_id }}">
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-meta-h1{{ language.language_id }}">{{ entry_meta_h1 }}</label>
                                <div class="col-sm-10">
                                    <input type="text" name="manufacturer_description[{{ language.language_id }}][meta_h1]" value="{{ manufacturer_description[language.language_id] ? manufacturer_description[language.language_id].meta_h1 }}" placeholder="{{ entry_meta_h1 }}" id="input-meta-h1{{ language.language_id }}" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                                <div class="col-sm-10">
                                    <input type="text" name="manufacturer_description[{{ language.language_id }}][meta_title]" value="{{ manufacturer_description[language.language_id] ? manufacturer_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control" />
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-meta-description{{ language.language_id }}">{{ entry_meta_description }}</label>
                                <div class="col-sm-10">
                                    <textarea name="manufacturer_description[{{ language.language_id }}][meta_description]" rows="5" placeholder="{{ entry_meta_description }}" id="input-meta-description{{ language.language_id }}" class="form-control">{{ manufacturer_description[language.language_id] ? manufacturer_description[language.language_id].meta_description }}</textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-meta-keyword{{ language.language_id }}">{{ entry_meta_keyword }}</label>
                                <div class="col-sm-10">
                                    <textarea name="manufacturer_description[{{ language.language_id }}][meta_keyword]" rows="5" placeholder="{{ entry_meta_keyword }}" id="input-meta-keyword{{ language.language_id }}" class="form-control">{{ manufacturer_description[language.language_id] ? manufacturer_description[language.language_id].meta_keyword }}</textarea>
                                </div>
                            </div>
                            <div class="form-group">
                                <label class="col-sm-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                                <div class="col-sm-10">
                                    <textarea name="manufacturer_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="summernote" data-lang="{{ summernote }}" class="form-control">{{ manufacturer_description[language.language_id] ? manufacturer_description[language.language_id].description }}</textarea>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>
            ]]></add>
        </operation>
        <operation>
            <search index="5"><![CDATA[<div class="form-group">]]></search>
            <add offset="27" position="replace"><![CDATA[]]></add>
        </operation>
        <operation>
            <search><![CDATA[</form>]]></search>
            <add offset="1" position="before"><![CDATA[
                <div class="tab-pane" id="tab-data">
                    <div class="form-group">
                        <label class="col-sm-2 control-label">{{ entry_store }}</label>
                        <div class="col-sm-10">
                        <div class="well well-sm" style="height: 150px; overflow: auto;">
                            {% for store in stores %}
                                <div class="checkbox">
                                    <label>
                                        {% if store.store_id in manufacturer_store %}
                                            <input type="checkbox" name="manufacturer_store[]" value="{{ store.store_id }}" checked="checked" />
                                            {{ store.name }}
                                            {% else %}
                                            <input type="checkbox" name="manufacturer_store[]" value="{{ store.store_id }}" />
                                            {{ store.name }}
                                        {% endif %}
                                    </label>
                                </div>
                            {% endfor %}
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-image">{{ entry_image }}</label>
                        <div class="col-sm-10"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a>
                            <input type="hidden" name="image" value="{{ image }}" id="input-image" />
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label" for="input-sort-order">{{ entry_sort_order }}</label>
                        <div class="col-sm-10">
                            <input type="text" name="sort_order" value="{{ sort_order }}" placeholder="{{ entry_sort_order }}" id="input-sort-order" class="form-control" />
                        </div>
                    </div>
                </div>
                <div class="tab-pane" id="tab-design">
                    <div class="table-responsive">
                        <table class="table table-bordered table-hover">
                            <thead>
                                <tr>
                                  <td class="text-left">{{ entry_store }}</td>
                                  <td class="text-left">{{ entry_layout }}</td>
                                </tr>
                            </thead>
                            <tbody>
                                {% for store in stores %}
                                    <tr>
                                        <td class="text-left">{{ store.name }}</td>
                                        <td class="text-left">
                                            <select name="manufacturer_layout[{{ store.store_id }}]" class="form-control">
                                                <option value=""></option>
                                                {% for layout in layouts %}
                                                    {% if manufacturer_layout[store.store_id] and manufacturer_layout[store.store_id] == layout.layout_id %}
                                                        <option value="{{ layout.layout_id }}" selected="selected">{{ layout.name }}</option>
                                                    {% else %}
                                                        <option value="{{ layout.layout_id }}">{{ layout.name }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            ]]></add>
        </operation>
        <operation>
            <search><![CDATA[{{ footer }}]]></search>
            <add position="before"><![CDATA[
                <script type="text/javascript" src="view/javascript/summernote/summernote.js"></script>
                <link href="view/javascript/summernote/summernote.css" rel="stylesheet"/>
                <script type="text/javascript" src="view/javascript/summernote/summernote-image-attributes.js"></script>
                <script type="text/javascript" src="view/javascript/summernote/opencart.js"></script>
            ]]></add>
        </operation>
    </file>
    <file path="catalog/model/catalog/manufacturer.php">
        <operation>
            <search><![CDATA[public function getManufacturer($manufacturer_id) {]]></search>
            <add position="before"><![CDATA[
                public function getManufacturerLayoutId($manufacturer_id) {
                    $query = $this->db->query("SELECT * FROM " . DB_PREFIX . "manufacturer_to_layout WHERE manufacturer_id = '" . (int)$manufacturer_id . "' AND store_id = '" . (int)$this->config->get('config_store_id') . "'");
                    if ($query->num_rows) {
                        return $query->row['layout_id'];
                    } else {
                        return 0;
                    }
                }
		    ]]></add>
        </operation>
        <operation>
            <search index="0"><![CDATA[SELECT *]]></search>
            <add position="replace"><![CDATA[SELECT DISTINCT *]]></add>
        </operation>
        <operation>
            <search><![CDATA["manufacturer m LEFT JOIN "]]></search>
            <add position="replace"><![CDATA["manufacturer m LEFT JOIN " . DB_PREFIX . "manufacturer_description md ON (m.manufacturer_id = md.manufacturer_id) LEFT JOIN "]]></add>
        </operation>
        <operation>
            <search><![CDATA[m.manufacturer_id = '" . (int)$manufacturer_id . "]]></search>
            <add position="replace"><![CDATA[m.manufacturer_id = '" . (int)$manufacturer_id . "' AND md.language_id = '" . (int)$this->config->get('config_language_id') . "]]></add>
        </operation>
        <operation>
            <search><![CDATA[m2s.store_id = '" . (int)$this->config->get('config_store_id') . "]]></search>
            <add position="replace"><![CDATA[m2s.store_id = '" . (int)$this->config->get('config_store_id') . "' AND md.language_id = '" . (int)$this->config->get('config_language_id') . "]]></add>
        </operation>
        <operation>
            <search><![CDATA['manufacturer.' . (int)$this->config->get('config_store_id')]]></search>
            <add position="replace"><![CDATA['manufacturer.' . (int)$this->config->get('config_store_id') . '.' . (int)$this->config->get('config_language_id')]]></add>
        </operation>
    </file>
    <file path="catalog/controller/product/manufacturer.php">
        <operation>
            <search><![CDATA[$this->document->setTitle($manufacturer_info['name']);]]></search>
            <add position="replace"><![CDATA[
                if ($manufacturer_info['meta_title']) {
                    $this->document->setTitle($manufacturer_info['meta_title']);
                } else {
                    $this->document->setTitle($manufacturer_info['name']);
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$url = '';]]></search>
            <add position="before"><![CDATA[
                $this->document->setDescription($manufacturer_info['meta_description']);
                $this->document->setKeywords($manufacturer_info['meta_keyword']);
                $data['description'] = html_entity_decode($manufacturer_info['description'], ENT_QUOTES, 'UTF-8');

                if ($manufacturer_info['image']) {
                    $data['thumb'] = $this->model_tool_image->resize($manufacturer_info['image'], $this->config->get('theme_' . $this->config->get('config_theme') . '_image_manufacturer_width'), $this->config->get('theme_' . $this->config->get('config_theme') . '_image_manufacturer_height'));
                } else {
                    $data['thumb'] = '';
                }
		    ]]></add>
        </operation>
        <operation>
            <search><![CDATA[$data['heading_title'] = $manufacturer_info['name'];]]></search>
            <add position="replace"><![CDATA[
                if ($manufacturer_info['meta_h1']) {
                    $data['heading_title'] = $manufacturer_info['meta_h1'];
                } else {
                    $data['heading_title'] = $manufacturer_info['name'];
                }
		    ]]></add>
        </operation>
    </file>
</modification>